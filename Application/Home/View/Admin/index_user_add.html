<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<title>道路运输行业现场稽查系统</title>
		<link rel="stylesheet" type="text/css" href="__CSS__/index.css"/>
		<link rel="stylesheet" type="text/css" href="__CSS__/search.css"/>
		<script src="__JS__/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="__JS__/jquery.min-8.3.js" type="text/javascript"></script>
		<script src="__JS__/layer/layer.js"></script>
		<style type="text/css">
			.center_right .search_from .input {
			    width: 65%;
			}
		</style>
	</head>
	<body>
		<!--
        	作者：985498384@qq.com
        	时间：2016-05-09
        	描述：框架头部
        -->
		<include file="Public:head" />
		<!--
        	作者：985498384@qq.com
        	时间：2016-05-09
        	描述：中间部分
        -->
		<div class="center">
			<div class="center_left">
				<dl>
					<a href="index.html"><dt id="user" class="dldt">用户管理</dt></a>
					<a href="index_sim.html"><dt id="sim" class="dldt">SIM卡管理</dt></a>
					<a href="index_pda.html"><dt id="fal" class="dldt">终端管理</dt></a>
					<a href="user.html"><dt id="admin" class="dldt border">角色管理</dt>	</a>
				</dl>
			</div>
			<div class="center_right" style="width: 385px;margin-bottom: 40px;">
				<div class="title_1" style="top: 180px; font-family: '微软雅黑';font-size: 18px; width: 120px;">
					添加用户
				</div>
				<form action="" method="post">
				<div class="search_from" style="margin-top: 10px; height: 660px; width: 370px;">
					<dl style="position: relative">
						<dd style="width: 100%">
							<div class="left">执法证号</div>
							<div class="right">
								<input type="text" class="input" placeholder="必填" name="" id="zfzh" value="" />
							</div>
							<div class="clear"></div>
						</dd>
						<dd style="width: 100%; ">
							<div class="left">姓名</div>
							<div class="right">
								<input placeholder="必填" type="text" class="input" name="name" id="name" value="{$name}" />
							</div>
							<div class="clear"></div>
						</dd>
						<dd style="width: 100%;">
							<div class="left">姓名</div>
							<div class="right">
								<input placeholder="必填" type="text" class="input" name="" id="sex" value="" />
							</div>
							<div class="clear"></div>
						
						</dd>
						<dd style="width: 100%;">
							<div class="left">执法大队</div>
							<div class="right">
								<input type="text" placeholder="必填" class="input xxl" readonly  name="" id="dd" value="" />
								<ul class="dadui show" id="dadui" >
									<volist name="compName" id="v">
										<li value="{$v.ZFDWMC}">{$v.ZFDWMC}</li>
									</volist>
								</ul>
							</div>
							<div class="clear"></div>
						</dd>
						<dd style="width: 100%;">
							<div class="left">所属中队</div>
							<div class="right">
								<!-- <input type="text" class="input" name="" id="zd" value="" /> -->
								<input type="text" readonly style="height: 25px;" class="input xxl" name="zd" id="zd" value="{$zd}" />
								<ul class="dadui show"  id="zhongdui" style="height: 0px;border: 1px solid #fff;width: 39%;">
									<!-- <volist name="compName" id="v">
										<li value="{$v.compName}">{$v.compName}</li>
									</volist> -->
								</ul>
							</div>
							<div class="clear"></div>
						
						</dd>
						<dd style="width: 100%;">
							<div class="left">所属车组</div>
							<div class="right">
								<!-- <input type="text" class="input" name="" id="cz" value="" /> -->
								<input type="text" readonly style="height: 25px;" class="input xxl" name="cz" id="cz" value="{$cz}" />
								<ul class="dadui show" id="chezu" style="height: 0px;border: 1px solid #fff;width: 39%;">
									<!-- <volist name="compName" id="v">
										<li value="{$v.compName}">{$v.compName}</li>
									</volist> -->
								</ul>
							</div>
							<div class="clear"></div>
						
						</dd>
						<dd style="width: 100%;">
							<div class="left">上级单位</div>
							<div class="right">
								<input type="text" class="input" name="" id="sjdw" value="" />
							</div>
							<div class="clear"></div>
						</dd>
						<dd style="width: 100%;">
							<div class="left">联系电话</div>
							<div class="right">
								<input type="text" placeholder="必填" class="input" name="" id="mobile" value="" />
							</div>
							<div class="clear"></div>
						</dd>
						<dd style="width: 100%;">
							<div class="left">密码</div>
							<div class="right">
								<input placeholder="必填" type="password" class="input" name="" id="pwd" value="" />
							</div>
							<div class="clear"></div>
						</dd>
						<dd style="width: 100%">
							<div class="left">确认密码</div>
							<div class="right">
								<input type="password" placeholder="必填" class="input" name="" id="sure" value="" />
							</div>
							<div class="clear"></div>
						</dd>
						<dd style="width: 100%">
							<div class="left">权限级别</div>
							<div class="right">
								<input type="text" placeholder="必填" class="input xxl"  id="qx"  value=""readonly />
								<input type="hidden" class="input" style="height: 25px;  width:50%;" id="qx1" name="qx" value="" readonly />
								<ul class="dadui show" id="role" style="width: 39%;">
									<volist name="CC" id="v">
										<li><span>{$v.MEMO}</span><p class="show">{$v.ID}<p></li>
									</volist>
								</ul>
							</div>
							<div class="clear"></div>
						</dd>
						
					</dl>
				</div>
				<div id="button" style="margin-right: 10px">
					<input class="submit"  style="color: white; font-size: 16px; border: 0;"  type="button" name="" id="" value="添加" />
				</div>
				</form>
			</div>
		</div>
	</body>
</html>
<script>
	$("#dd").click(function(){
		if($("#dadui").hasClass('show'))
		{
			$("#dadui").removeClass('show');
		}
		else

		{
			$("#dadui").addClass('show');
		}

		$("#dadui li").click(function(){
			var ht = $(this).html() ;
			$("#dd").val(ht);
			$('#zhongdui').css('height',0);
			$('#zhongdui').css('border','1px solid #fff');
			$("#dadui").addClass('show');
			$.ajax({
				type : 'POST',
				url : '__APP__/Home/Admin/getGroups',
				data : {
					zfdwmc : ht,
				},
				dataType : 'json',
				timeout : 3000,
				success : function(data) {
					var str = '';
					for (var i = 0; i < data.length; i++) {
						str += '<li value="'+data[i]['SSZD']+'">'+data[i]['SSZD']+'</li>'
					};
					$('#zhongdui').css('height',200);
					$('#zhongdui').css('border','1px solid #41C3D6');
					$('#zhongdui').css('display','none');
					$('#zhongdui').html(str);
					$('#zd').val('--请选择--');
					$('#cz').val('--请选择--');

					
					 console.log(data);
				}
			});
		})
	})
	$("#zd").click(function(){
		/*if($("#zhongdui").hasClass('show'))
		{
			$("#zhongdui").removeClass('show');
		}
		else

		{
			$("#zhongdui").addClass('show');
		}*/
		$('#zhongdui').css('display','block');
		$("#zhongdui li").click(function(){
			var sszd = $(this).html() ;
			$('#zhongdui').css('height',0);
			$('#zhongdui').css('border','1px solid #fff');
			$("#zd").val(sszd);
			var zfdwmc = $("#dd").val();
			//$("#zhongdui").addClass('show');
			$('#zhongdui').css('display','none');
			$("#zhongdui").removeClass('show');
			$.ajax({
				type : 'POST',
				url : '__APP__/Home/Admin/getGroups',
				data : {
					zfdwmc : zfdwmc,
					sszd : sszd,
				},
				dataType : 'json',
				timeout : 3000,
				success : function(data) {
					var str = '';
					for (var i = 0; i < data.length; i++) {
						str += '<li value="'+data[i]['SSCZ']+'">'+data[i]['SSCZ']+'</li>'
					};
					$('#chezu').css('height',200);
					$('#chezu').css('border','1px solid #41C3D6');
					$('#chezu').css('display','none');
					$('#chezu').html(str);
					$('#cz').val('--请选择--');

					
					 console.log(data);
				}
			});
		})
	});
	$("#cz").click(function(){
		/*if($("#chezu").hasClass('show'))
		{
			$("#chezu").removeClass('show');
		}
		else

		{
			$("#chezu").addClass('show');
		}*/
		$('#chezu').css('display','block');
		$("#chezu li").click(function(){
			$('#chezu').css('height',0);
			$('#chezu').css('border','1px solid #fff');
			var cz = $(this).html() ;
			$("#cz").val(cz);
			$('#chezu').css('display','none');
		})
	})
	$("#qx").click(function(){
		if($("#role").hasClass('show'))
		{
			$("#role").removeClass('show');
		}
		else

		{
			$("#role").addClass('show');
		}

		$("#role li").click(function(){
			var ht = $(this).children('span').html() ;
			var ht1 = $(this).children('p').html() ;
			$("#qx1").val(ht1);
			$("#qx").val(ht);
			$("#role").addClass('show');
		})
	})
	$("#change").click(function(){
		if($("#info").hasClass('show'))
		{
			$("#info").removeClass('show');
			$(".change").html('<img src="__IMG__/top.png"/>')
		}
		else
		{
			$("#info").addClass('show');
			$(".change").html('<img src="__IMG__/down.png"/>')
		}
	})
	$(".head_top").click(function(){
		$("#info").addClass('show');
		$(".change").html('<img src="__IMG__/down.png"/>')
	})
	$(".center").click(function(){
		$("#info").addClass('show');
		$(".change").html('<img src="__IMG__/down.png"/>')
	})
	
	$("#user").click(function(){
		$("#user").addClass('border');
		$("#sim").removeClass('border');
		$("#fal").removeClass('border');
		$("#admin").removeClass('border');				
	})
	$("#sim").click(function(){
		$("#user").removeClass('border');
		$("#sim").addClass('border');
		$("#fal").removeClass('border');
		$("#admin").removeClass('border');				
	})
	$("#fal").click(function(){
		$("#user").removeClass('border');
		$("#sim").removeClass('border');
		$("#fal").addClass('border');
		$("#admin").removeClass('border');				
	})
	$("#admin").click(function(){
		$("#user").removeClass('border');
		$("#sim").removeClass('border');
		$("#fal").removeClass('border');
		$("#admin").addClass('border');				
	})

	$("#button").click(function(){
		 var zfzh = $.trim($("#zfzh").val());
		 var name = $.trim($("#name").val());
		 var sex = $.trim($("#sex").val());
		 var dd =  $.trim($("#dd").val());
		 var cz = $("#cz").val();
		 var sjdw = $("#sjdw").val();
		 var mobile = $.trim($("#mobile").val());
		 var pwd = $.trim($("#pwd").val());
		 var sure = $.trim($("#sure").val());
		 var role_id = $("#qx1").val();
		var zd = $("#zd").val();

		if(zfzh==''){
			layer.alert('请填写执法证号', {
				skin: 'layui-layer-molv' //样式类名
				,closeBtn: 0
			} )
			return false;
		}
		if(name==''){
			layer.alert('请填写名字', {
				skin: 'layui-layer-molv' //样式类名
				,closeBtn: 0
			} )
			return false;
		}
		if(sex==''){
			layer.alert('请填写性别', {
				skin: 'layui-layer-molv' //样式类名
				,closeBtn: 0
			} )
			return false;
		}
		if(dd==''){
			layer.alert('请选择大队', {
				skin: 'layui-layer-molv' //样式类名
				,closeBtn: 0
			} )
			return false;
		}
		if(mobile==''){
			layer.alert('请填写电话号码', {
				skin: 'layui-layer-molv' //样式类名
				,closeBtn: 0
			} )
			return false;
		}
		if(pwd==''){
			layer.alert('请填写密码', {
				skin: 'layui-layer-molv' //样式类名
				,closeBtn: 0
			} )
			return false;
		}
		if(pwd!=sure){
			layer.alert('两次输入的密码不一样', {
				skin: 'layui-layer-molv' //样式类名
				,closeBtn: 0
			} )
			return false;
		}
		if(role_id==''){
			layer.alert('请选择修改的权限', {
				skin: 'layui-layer-molv' //样式类名
				,closeBtn: 0
			} )
			return false;
		}

		if(role_id==''){
			layer.alert('请选择修改的权限', {
				skin: 'layui-layer-molv' //样式类名
				,closeBtn: 0
			} )
			return false;
		}
		layer.confirm('你确认该账号权限吗？', {
			btn: ['修改','取消'] //按钮
		}, function(){
			$.post("{:U('Admin/ajaxAddUser')}",{ZFZH:zfzh,role_id:role_id,name:name,sex:sex,pwd:pwd,mobile:mobile,dd:dd,cz:cz,sjdw:sjdw,zd:zd},function(data){
				if(data.err == 0)
				{
					layer.msg(data.errorMsg, {icon: 1});
					window.history.go(-1);
				}
				else
				{
					layer.msg(data.errorMsg, {icon: 2});
				}
			})
		} )
	})
</script>
