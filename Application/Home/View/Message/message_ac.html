<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="chrome=1,IE=edge">
		<title>道路运输行业现场稽查系统</title>
		<include file="Public:common" />
		<!--  -->

		<link rel="stylesheet" type="text/css" href="__CSS__/index.css"/>
		<link rel="stylesheet" type="text/css" href="__CSS__/search.css"/>
		<link rel="stylesheet" type="text/css" href="__CSS__/aduit.css"/>
		<script src="__JS__/layer/layer.js"></script>
		<script type="text/javascript" src="__JS__/laydate.js"></script>
		<link rel="stylesheet" type="text/css" href="__CSS__/query.css"/>
	</head>
	<body>

		<include file="Public:head" />
		<input type="hidden" id="rode" value="{$rode}"/>
		<div class="center">
			<div class="center_left">
				<dl>
					<a href="{:U('Home/Message/message_ac')}"><dt id="user" class="dldt border" >道路运输执法记录查询</dt></a>
				</dl>
			</div>
				<div class="center_right">
				
				
				<form action="##" method="post">	
				<div class="title_1 c-title">检索项</div>

				<div class="search_from msg-search" style="margin-top: 10px;height: 100%; width: 100%;">
					<dl style="position: relative">
						<dd>
							<div class="left">车牌号码</div>
							<div class="right">
								<input type="text" style="height:25px;" class="input" name="vName" id="vName" value="" />
							</div>
							<div class="clear"></div>
						</dd>
						<dd >
							<div class="left">姓名</div>
							<div class="right"><input type="text" style="height: 25px;" class="input" name="driverName" id="driverName" value="" /></div>
							<div class="clear"></div>
						</dd>
						<dd >
							<div class="left">从业资格证</div>
							<div class="right"><input type="text" style="height: 25px; " class="input" name="cyzg" id="cyzg" value="" /></div>
							<div class="clear"></div>

						</dd>
						<dd>
							<div class="left">大队</div>
							<div class="right">
								<input type="text" readonly style="height: 25px;" class="input xxl" name="dd" id="dd" value="--请选择--" />
								<ul class="dadui" id="dadui"  style="width:60%;display:none;">
									<li>全部</li>
									<volist name="compName" id="v">
										<li value="{$v.ZFDWMC}">{$v.ZFDWMC}</li>
									</volist>
								</ul>
							</div>
							<div class="clear"></div>
						</dd>
						<!--<dd>
							<div class="left">稽查人员</div>
							<div class="right">
								<input type="text" readonly style="height: 25px;" class="input xxl" name="zd" id="zd" value="&#45;&#45;请选择&#45;&#45;" />
								<ul class="zhongdui" id="zhongdui" style="display:none;"></ul>
							</div>
							<div class="clear"></div>

						</dd>
						<dd>
							<div class="left">行业</div>
							<div class="right">
								<input type="text" readonly style="height: 25px;" class="input xxl" name="hy" id="hy" value="&#45;&#45;请选择&#45;&#45;" />
								<ul class="dadui" id="hangye" style="display:none;">
									<li>全部</li>
									<volist name="urc_hy" id="v">
										<li value="{$v.name}">{$v.name}</li>
									</volist>
								</ul>
							</div>
							<div class="clear"></div>

							
						</dd>-->

						<dd>
							<div class="left">公司名称</div>
							<div class="right">
								<input type="text" style="height: 25px;" class="input"  name="corpName" id="corpName" value="{$R.corpName}" />
							</div>
							<div class="clear"></div>
						</dd>
						<dd>
							
							<div class="left">起始时间</div>
							<div class="right">
								<input placeholder="请输入日期" name="startTime" class="easyui-datetimebox" style="height: 25px;width: 100%;position: relative;border: 1px solid #41C3D6;border-radius: 0;" id="demo" value="{$startDate}">
							</div>
							<div class="clear"></div>
						</dd>
						<dd>
							<div class="left">结束时间</div>
							<div class="right">
								<input placeholder="请输入日期" name="endTime" class="easyui-datetimebox" style="height: 25px;width: 100%;position: relative;border: 1px solid #41C3D6;border-radius: 0;" id="demo1" value="{$endDate}">
							</div>
							<div class="clear"></div>
						</dd>
						<div class="submit">			
							<input type="button" name="" id="search_btn" value="查询" />               
						</div>
						<div class="clear"></div>					
					</dl>
					<div class="clear"></div>
				</div>
				
				</form>
			
				<!-- =============结果====================== -->
				<div style="margin-top:30px;">
					<if condition="$show eq 'message_ac_end'">
						<div class="center_right_top">
							<span>查询结果</span>
							<if condition="($rode eq 1)">
								<div class="delAll">删除选择项</div>
								<else />
							</if>
							<!--<if condition="($rode eq 1)">
								<div class="delAll">删除选择项</div>
								<else />
							</if>-->
							<div class="clear"></div>
						</div>
						<div class="center_right_botton">
							<input type="hidden" id="nums" name="" value="">
							<!--startprint6-->
						
							<table id="table" data-height="268" class="table table-striped table-bordered table-hover">
							    <thead>
							    <tr>
							        <th data-field="state" data-checkbox="true"></th>
							        <th data-field="id" data-align="center" data-sortable="true"></th>
									<th data-field="jcbh" data-align="center" data-sortable="true"><div style="width:60px">稽查编号</div></th>
									<th data-field="vname" data-align="center" data-sortable="true"><div style="width:40px">车牌号码</div></th>
									<!-- <th data-field="CORPNAME" data-align="center" data-sortable="true"><div style="width:140px">所属单位(车辆)</div></th> -->
									<th data-field="driverName" data-align="center" data-sortable="true"><div style="width:60px">驾驶员姓名</div></th>
									<!-- <th data-field="rcomp" data-align="center" data-sortable="true"><div style="width:160px">所属单位(驾驶员)</div></th>
                                    <th data-field="vcomp" data-align="center" data-sortable="true"><div style="width:140px">企业名称</div></th> -->
									<th data-field="zfry1" data-align="center" data-sortable="true"><div style="width:60px">执法人员1</div></th>
									<th data-field="zfry2" data-align="center" data-sortable="true"><div style="width:60px">执法人员2</div></th>
									<th data-field="zfdwmc" data-align="center" data-sortable="true"><div style="width:60px">大队</div></th>
									<!-- <th data-field="SSZD" data-align="center" data-sortable="true"><div style="width:50px">中队</div></th>
                                    <th data-field="SSCZ" data-align="center" data-sortable="true"><div style="width:50px">车组</div></th> -->
									<th data-field="zfsj" data-align="center" data-sortable="true" data-formatter="FormatterSTime"><div style="width:120px">稽查时间</div></th>
									<!-- <th data-field="ADDRESS" data-align="center" data-sortable="true"><div style="width:150px">稽查地点</div></th> -->
									<th data-field="hylb" data-align="center" data-sortable="true"><div style="width:80px">稽查行业</div></th>
									<th data-field="status" data-align="center" data-sortable="true" data-formatter="FormatterStatus"><div style="width:60px">稽查结果</div></th>
							        <th data-field="action" data-formatter="actionFormatter" data-align="center" data-events="actionEvents"><div style="width:60px">操作</div></th>
							    </tr>
							    </thead>
							</table>
							<!--endprint6-->
							
							</div>
							
						<!-- <div class="return">
							<input type="submit" onclick="preview(6)" name="" id="" value="打印" /> 
						</div> -->
						<div class="return" style="margin-right: 15px">
							<a href="javascript:ExportCsv();"><input type="submit" name="" id="" value="导出" /> </a>
						</div>
					</div>
					<!-- =============结果====================== -->
				</div>
				
				<div style="clear:both;"></div>
		</div>
		
		
	</body>
</html>
<script>


	$("#dd").click(function(event){
		event.stopPropagation();
		$("#dadui").show();

		$('#dadui li').unbind('click');
		$("#dadui li").click(function(e){
			e.stopPropagation();
			var ht = $(this).html() ;
			$("#dd").val(ht);
			$("#dadui").hide();
			$.ajax({
				type : 'POST',
				url : '__APP__/Home/Message/ajaxGetPersonnel',
				data : {
					ht : ht,
				},
				dataType : 'json',
				timeout : 3000,
				success : function(data) {
					var str = '<li>全部</li>';
					for (var i = 0; i < data.length; i++) {
						str += '<li value="'+data[i]['NAME']+'">'+data[i]['NAME']+'</li>'
					};
					$("#zhongdui").hide();
					$('#zhongdui').html(str);

					//$('#chezu').html(str);
					$('#zd').val('--请选择--');
					
					 //console.log(data);
				}
			});
		})
	})

	$("#zd").click(function(event){
		event.stopPropagation();
		$("#zhongdui").show();
		/*$('#zhongdui').css('height','200px');
		$('#zhongdui').css('display','block');*/
		var zhongdui = $('#zhongdui').html();
		
		$('#zhongdui li').unbind('click');	
		$("#zhongdui li").click(function(){
			var sszd = $(this).html() ;
			$("#zhongdui").hide();
			$("#zd").val(sszd);
			var zfdwmc = $("#dd").val();
			//$("#zhongdui").addClass('disshow');
			
		})
		
		
	});

	$("#hy").click(function(event){
		event.stopPropagation();
		/*if($("#hangye").hasClass('disshow'))
		{
			$("#hangye").removeClass('disshow');
		}
		else

		{
			$("#hangye").addClass('disshow');
		}*/
		$("#hangye").show();
		$("#hangye li").click(function(){
			var ht = $(this).html() ;
			$("#hy").val(ht);
			$("#hangye").hide();
		})
	})
	$(document).click(function(){
	    $("#dadui").hide();
	    $("#zhongdui").hide();
	    $("#chezu").hide();
	    $("#hangye").hide();
	});
</script>



<script type="text/javascript">
		//重新装载数据
	function loadData(){
        //获得查询参数
        var vName = $("#vName").val();//车牌号码
        var driverName = $("#driverName").val();//姓名
        var cyzg = $("#cyzg").val();//从业资格证
        var dd = $("#dd").val();
        var zd = $("#zd").val();
        var hy = $("#hy").val();
        var corpName = $("#corpName").val();//公司
        var st = $("input[name='startTime']").val();
        var end = $("input[name='endTime']").val();
        function getParams(params){
            //vName driverName cyzg dd zd hy corpName
            var vNameReg = /^[\u4e00-\u9fa5]{1}[A-Z]{1}[A-Z_0-9]{5}$/;
            var driverNameReg = /^[\u4E00-\u9FA5]{1,6}$/;
            var corpNameReg = /^[\u4E00-\u9FA5]{0,}$/;
            var cyzgReg = /^\w+$/;
			/*if(vName != ''){
			 if (!vNameReg.test(vName)) {
			 layer.alert('请填写正确的车牌号码', {
			 skin: 'layui-layer-molv' //样式类名
			 ,closeBtn: 0
			 } )
			 return false;
			 }
			 }*/
            if(driverName != ''){
                if (!driverNameReg.test(driverName)) {
                    layer.alert('请填写正确的姓名', {
                        skin: 'layui-layer-molv' //样式类名
                        ,closeBtn: 0
                    } )
                    return false;
                }
            }
            if(corpName != ''){
                if (!corpNameReg.test(corpName)) {
                    layer.alert('请填写正确的公司名称', {
                        skin: 'layui-layer-molv' //样式类名
                        ,closeBtn: 0
                    } )
                    return false;
                }
            }
            if(cyzg != ''){
                if (!cyzgReg.test(cyzg)) {
                    layer.alert('请填写正确的从业资格证', {
                        skin: 'layui-layer-molv' //样式类名
                        ,closeBtn: 0
                    } )
                    return false;
                }
            }
            if(st != '' || end !=''){
                if(st>=end){
                    layer.alert('开始时间不能大于结束时间', {
                        skin: 'layui-layer-molv' //样式类名
                        ,closeBtn: 0
                    } )
                    return false;
                }
            }
            if(dd=='--请选择--' || dd=='全部'){
                dd = '';
            }
            if(zd=='--请选择--'){
                zd = '';
            }
            if(hy=='--请选择--'){
                hy = '';
            }
            var temp  = {
                limit: params.limit,   //页面大小
                offset: params.offset,  //页码
                maxrows: params.limit,
                pageindex:params.pageNumber,
                vName:vName,
                driverName:driverName,
                cyzg:cyzg,
                dd:dd,
                zd:zd,
                hy:hy,
                startTime:st,
                endTime:end,
                corpName:corpName,
                sort: params.sort,  //排序列名
                sortOrder: params.order//排位命令（desc，asc）
            };
            return temp;
        }

		$('#table').bootstrapTable('refreshOptions',{pageNumber:1,queryParams:getParams});
	}


    function FormatterStatus(value, row, index){
        //-1，正常 1；违法
		if(value==-1){
		    return val='正常'
		}else if(value == 1){
            return val = '违法';
        }else{
		    return val='正常'//其他状态。为以后多状态预留
		}
       // return [
         //   val
        ///].join('');
    }
	//导出
	function ExportCsv(){
		var vName = $("#vName").val();//车牌号码
		var driverName = $("#driverName").val();//姓名
		var cyzg = $("#cyzg").val();//从业资格证
		var dd = $("#dd").val();
		var zd = $("#zd").val();
		var hy = $("#hy").val();
		var corpName = $("#corpName").val();//公司
		var st = $("input[name='startTime']").val();
		var end = $("input[name='endTime']").val();

		var vNameReg = /^[\u4e00-\u9fa5]{1}[A-Z]{1}[A-Z_0-9]{5}$/;
		var driverNameReg = /^[\u4E00-\u9FA5]{1,6}$/;
		var corpNameReg = /^[\u4E00-\u9FA5]{0,}$/;
		var cyzgReg = /^\w+$/;

		if(dd=='--请选择--'){
			dd = '';
		}
		if(zd=='--请选择--'){
			zd = '';
		}
		if(hy=='--请选择--'){
			hy = '';
		}
		var temp  = {
				vName:vName,
            	driverName:driverName,
            	cyzg:cyzg,
            	dd:dd,
				zd:zd,
				hy:hy,
				startTime:st,
				endTime:end,
				corpName:corpName,
				offset: 0,  //页码
            	maxrows: 10,
		};
		$.getJSON("__APP__/Home/Message/ajaxmessage_ac",temp,function(json){
		    		//console.log(json);
		    if(json.total==0){
				layer.msg('数据为空,不能导出', {icon: 2});
			}else if(json.total > 10000){
				layer.msg('一次导出数据不能超过1万条，请修改查询条件', {icon: 2});
			}else{
				//alert(json.total);
				window.location.href = "__APP__/Home/ExportCsv/get_Register_All?driverName="+driverName+"&cyzg="+cyzg+"&vName="+vName+"&startTime="+st+"&endTime="+end+"&dd="+dd+"&zd="+zd+"&corpName="+corpName;
			}
		});

	}
	$(function () {
		/****/
        //获得查询参数
			var vName = $("#vName").val();//车牌号码
			var driverName = $("#driverName").val();//姓名
			var cyzg = $("#cyzg").val();//从业资格证
			var dd = $("#dd").val();
			var zd = $("#zd").val();
			var hy = $("#hy").val();
			var corpName = $("#corpName").val();//公司
			var st = $("input[name='startTime']").val();
			var end = $("input[name='endTime']").val();
        function getParams(params){
            //vName driverName cyzg dd zd hy corpName
            var vNameReg = /^[\u4e00-\u9fa5]{1}[A-Z]{1}[A-Z_0-9]{5}$/;
            var driverNameReg = /^[\u4E00-\u9FA5]{1,6}$/;
            var corpNameReg = /^[\u4E00-\u9FA5]{0,}$/;
            var cyzgReg = /^\w+$/;
			/*if(vName != ''){
			 if (!vNameReg.test(vName)) {
			 layer.alert('请填写正确的车牌号码', {
			 skin: 'layui-layer-molv' //样式类名
			 ,closeBtn: 0
			 } )
			 return false;
			 }
			 }*/
            if(driverName != ''){
                if (!driverNameReg.test(driverName)) {
                    layer.alert('请填写正确的姓名', {
                        skin: 'layui-layer-molv' //样式类名
                        ,closeBtn: 0
                    } )
                    return false;
                }
            }
            if(corpName != ''){
                if (!corpNameReg.test(corpName)) {
                    layer.alert('请填写正确的公司名称', {
                        skin: 'layui-layer-molv' //样式类名
                        ,closeBtn: 0
                    } )
                    return false;
                }
            }
            if(cyzg != ''){
                if (!cyzgReg.test(cyzg)) {
                    layer.alert('请填写正确的从业资格证', {
                        skin: 'layui-layer-molv' //样式类名
                        ,closeBtn: 0
                    } )
                    return false;
                }
            }
            if(st != '' || end !=''){
                if(st>=end){
                    layer.alert('开始时间不能大于结束时间', {
                        skin: 'layui-layer-molv' //样式类名
                        ,closeBtn: 0
                    } )
                    return false;
                }
            }
            if(dd=='--请选择--' || dd=='全部'){
                dd = '';
            }
            if(zd=='--请选择--'){
                zd = '';
            }
            if(hy=='--请选择--'){
                hy = '';
            }
            var temp  = {
                limit: params.limit,   //页面大小
                offset: params.offset,  //页码
                maxrows: params.limit,
                pageindex:params.pageNumber,
                vName:vName,
                driverName:driverName,
                cyzg:cyzg,
                dd:dd,
                zd:zd,
                hy:hy,
                startTime:st,
                endTime:end,
                corpName:corpName,
                sort: params.sort,  //排序列名
                sortOrder: params.order//排位命令（desc，asc）
            };
            return temp;
        }
		var height = $(document).height();
		$('.center .center_left').css('min-height',height+310);

		$('#table').bootstrapTable({
	        url: '__APP__/Home/Message/ajaxmessage_ac',         //请求后台的URL（*）
            method: 'get',                      //请求方式（*）
            toolbar: '#toolbar',                //工具按钮用哪个容器
            striped: true,                      //是否显示行间隔色
            cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
            pagination: true,                   //是否显示分页（*）
            sortable: false,                     //是否启用排序
            sort:"ID",
			sortOrder: "asc",                   //排序方式
            queryParams: getParams,//传递参数（*）
            sidePagination: "server",           //分页方式：client客户端分页，server服务端分页（*）
            pageNumber:1,                       //初始化加载第一页，默认第一页
            pageSize: 10,                       //每页的记录行数（*）
            pageList: [10, 25, 50, 100],        //可供选择的每页的行数（*）
            strictSearch: true,
            clickToSelect: true,                //是否启用点击选中行   
            height: false,                    //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度
            uniqueId: "id",                     //每一行的唯一标识，一般为主键列
            cardView: false,                    //是否显示详细视图
            detailView: false,                   //是否显示父子表
            formatLoadingMessage: function () {
            	$("#table th[data-field='id']").hide();
            	$("#table tr td:nth-child(2)").hide();
			    return "请稍等，正在加载中...";
			  },
			formatNoMatches: function () {  //没有匹配的结果
				$("#table th[data-field='id']").hide();
            	$("#table tr td:nth-child(2)").hide();
			    return '无符合条件的记录';
			},
            onLoadError: function (data) {
            	$("#table th[data-field='id']").hide();
            	$("#table tr td:nth-child(2)").hide();
			    //console.log(data);
			 },  
            onLoadSuccess: function(){  //加载成功时执行  
       //      	$('#table').find('input[name="btSelectItem"]').each(function(){
			    // 	var value = $(this).attr('data-index');
			    // 	alert(value);
			    // })
              //layer.msg("加载成功"); 
				$("#table th[data-field='id']").hide();
				$("#table tr td:nth-child(2)").hide();
              $('input[name="btSelectAll"],input[name="btSelectItem"]').click(function(){
			    	var str = '';
			    	var newstr = '';
			    	$('#nums').val('');
			    	$("tr.selected").each(function(e){
			    		
			    		str = $(this).children('td').eq(1).html();
			    		if(str&&str!='-'){
			    			newstr += str+',';
			    		}
			    		
			    	});
			    	newstr = newstr.substring(0,newstr.length-1);
			    	$('#nums').val(newstr);
			    }); 
            },
			onClickRow: function (row) {
				//console.log(row);
				//alert(row.JCBH);
				var str = '';
				var newstr = '';
				str = $('#nums').val();
				//alert(row.state);
				if(row.state == false || row.state == undefined){
					str = $('#nums').val();
					if(row.id){
						if(str){
							newstr = row.id+','+str+',';
						}else{
							newstr = row.id+','
						}
					}else{
						newstr = str+',';
					}
					
					
					//alert(newstr.substring(0,newstr.length-1));
					newstr = newstr.substring(0,newstr.length-1);
					//alert(newstr);
					
					
					//newstr = newstr.substring(0,newstr.Length-1);
				}else{
					var s = str.split(',');

					for(var i = 0;i<s.length;i++){
						
						if(s[i] == row.id){
							
							//alert(row.JCBH);
						}else{
							newstr += s[i]+',';
							//alert(newstr);
						}
						
					}
					newstr = newstr.substring(0,newstr.length-1);
				}
				
				
				$('#nums').val(newstr);
				/*if(row.state){
					//var str = '1122,33445,566';

				}*/
			    //window.location.href = "/qStock/qProInfo/" + row.ProductId;
			 },
	    });

	    $('#search_btn').bind('click',function(){
			loadData();
		});

	    $('.delAll').bind('click',function(){
	    	nums = $('#nums').val();
	    	if(nums==''){
	    		layer.alert('请选择删除项', {
					skin: 'layui-layer-molv' //样式类名
					,closeBtn: 0
				} )
				return false;
	    	}
	    	layer.confirm('确定删除麽', {
			   btn: ['确定', '取消'] //按钮
			},function(){
				//nums = $('#nums').val();
				$.getJSON("__APP__/Home/TaxiQuery/AuditingDel",{"num":nums},function(json){
		    		//console.log(json);
					if(json.error == 0){
						loadData();
						layer.msg(json.msg, {icon: 1});
					}else{
						layer.msg(json.msg, {icon: 2});
					}
				});
			},function(){
				layer.msg('取消删除', {icon: 1});
			});
	    	
	    })
	    
	    
	});

</script>

<script type="text/javascript">

	var _page = self; //当前页面
	var win = null; //弹出窗口
	////弹出窗口回调函数
	function closeWin(){
		if(win!=null){
			win.window('close');
		}
	}
	function openWin(){
		if(win!=null){
			win.window('open');
		}
	}
	function destroyWin(){
		if(win!=null){
			win.window('destroy');
		}
	}

	function actionFormatter(value, row, index) {
        var rode = $("#rode").val();
        if (rode != '9'){
            return [
                '<a class="like" href="javascript:void(0)" title="查看">',
                '查看',
                '</a>'
            ].join('');
        }else {
            return [
                '<a class="like" href="javascript:void(0)" title="查看">',
                '查看',
                '</a>',
                '<a class="edit ml10" href="javascript:void(0)" title="修改">',
                '修改',
                '</a>',
                '<a class="remove ml10" href="javascript:void(0)" title="删除">',
                '删除',
                '</a>'
            ].join('');
        }
	}
	//时间换算
	function FormatterSTime(value, row, index){
		var val = $.myTime.UnixToDate(value,true);
		return [
	        val
	    ].join('');
	}

	window.actionEvents = {
	    'click .like': function (e, value, row, index) {
	    	
	    	eval("var param="+JSON.stringify(row));
	    	//console.log(param);
	    	var winBody = $('<div style="overflow: hidden;" closed="true"></div>');
			var ifr =$('<iframe width="100%" height="100%" frameborder="0" src="__APP__/Home/Message/PersonnelInfo?vname='+param.vname+'&zfsj='+param.zfsj+'&hylb='+param.hylb+'"></iframe>');
			winBody.append(ifr);
			top.window.$('body').append(winBody);  
		    win=winBody.dialog({   
				title: "稽查详情",
				width: 800,   
				modal: true,   
				shadow: false,   
				closed: true,  
				height: 600,
				draggable:true,
				maximizable:true,
				inline:true,    
				onDestroy:function(){   
					winBody.remove();
				},
				buttons:[{
					text:'打印',
					iconCls:'icon-print',
					handler:function(){
						ifr[0].contentWindow.preview(6);
					}
				}]
			}).panel('move',{
			    top:200
			});
			win.window('open');
	        //alert('You click like icon, row: ' + JSON.stringify(row));
	        //console.log(value, row, index);
	    },
	    'click .edit': function (e, value, row, index) {
	        //alert('You click edit icon, row: ' + JSON.stringify(row));
	        //console.log(value, row, index);
	        eval("var param="+JSON.stringify(row));
	    	//console.log(param);
	    	var winBody = $('<div style="overflow: hidden;" closed="true"></div>');
			var ifr =$('<iframe width="100%" height="100%" frameborder="0" src="__APP__/Home/TaxiQuery/AuditingEdit?num='+param.id+'"></iframe>');
			winBody.append(ifr);
			top.window.$('body').append(winBody);  
		    win=winBody.dialog({   
				title: "稽查修改",
				width: 800,   
				modal: true,   
				shadow: false,   
				closed: true,  
				height: 500,
				draggable:true,
				maximizable:true,
				inline:true,    
				onDestroy:function(){   
					winBody.remove();
				},
				buttons:[{
					text:'提交',
					iconCls:'icon-ok',
					handler:function(){
						ifr[0].contentWindow.submit(_page,$);
					}
				}]
			}).panel('move',{
			    top:200
			});
			win.window('open');
	    },
	    'click .remove': function (e, value, row, index) {
	    	eval("var param="+JSON.stringify(row));
	    	//console.log(param);
            layer.confirm('确定删除麽', {
                btn: ['确定', '取消'] //按钮
            },function(){
	    	$.getJSON("__APP__/Home/TaxiQuery/AuditingDel",{"num":param.id},function(json){
	    		//console.log(json);
				if(json.error == 0){
					loadData();
					layer.msg(json.msg, {icon: 1});
				}else{
					layer.msg(json.msg, {icon: 2});
				}
			});
            },function(){
                layer.msg('取消删除', {icon: 1});
            });
	        //alert('You click remove icon, row: ' + JSON.stringify(row));
	        //console.log(value, row, index);
	    }
	};


	//提示
	function showDiv(msgs,status){
		/*layer.alert(msg, {
			skin: 'layui-layer-molv' //样式类名
			,closeBtn: status
		});*/
		if(status==1){
			loadData();
		}
		layer.msg(msgs, {icon: status});
	}
</script>



